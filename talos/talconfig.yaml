clusterName: home-cluster

talosVersion: v1.4.6
kubernetesVersion: v1.27.3

allowSchedulingOnMasters: true

endpoint: https://192.168.1.69:6443
domain: cluster.local
additionalApiServerCertSans:
  - home-cluster.local
  - 192.168.1.69
additionalMachineCertSans:
  - 192.168.1.69
  - home-cluster.local
cniConfig:
  name: none

nodes:
  - hostname: home-master
    ipAddress: 192.168.1.69
    installDiskSelector:
      model: Samsung SSD 840
      busPath: /pci0000:00/0000:00:1f.2/ata3/host2/target2:0:0/2:0:0:0/
    controlPlane: true
    nodeLabels:
      location: home
      openebs.io/engine: mayastor

controlPlane:
  patches:
    - |-
      cluster:
        apiServer:
          admissionControl:
            - name: PodSecurity
              configuration:
                exemptions:
                  namespaces: [mayastor, monitoring]
    - |-
      cluster:
        proxy:
          disabled: true
    - |-
      machine:
        install:
          extensions:
            - image: ghcr.io/siderolabs/i915-ucode:20230310
            - image: ghcr.io/siderolabs/intel-ucode:20230512
    - |-
      machine:
        sysctls:
          vm.nr_hugepages: "1024"
    - |-
      machine:
        files:
          - op: create
            path: /etc/cri/conf.d/20-customization.part
            content: |
              [plugins]
                [plugins."io.containerd.grpc.v1.cri"]
                  enable_unprivileged_ports = true
                  enable_unprivileged_icmp = true
