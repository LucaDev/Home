server {
    listen 80;
    server_name localhost;

    location / {
        root /media;
        autoindex on;
    }

    location /configure {
        content_by_lua_block {
            local args = ngx.req.get_uri_args()
            local system = args.system or "unknown"

            -- Set headers for file download
            ngx.header["Content-Disposition"] = 'attachment; filename="install.bat"'
            ngx.header["Content-Type"] = "text/plain"

            -- Send response
            ngx.say("m:\\" .. system .. "\\setup.exe")
        }
    }
}
