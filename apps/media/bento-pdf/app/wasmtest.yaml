---
apiVersion: gateway.envoyproxy.io/v1alpha1
kind: EnvoyExtensionPolicy
metadata:
  name: coraza-test
spec:
  targetRefs:
    - group: gateway.networking.k8s.io
      kind: HTTPRoute
      name: bento-pdf
  wasm:
    - name: coraza-filter
      rootID: ""
      failOpen: true
      code:
        type: Image
        image:
          url: ghcr.io/corazawaf/coraza-proxy-wasm:0.6.0
      config: |-
        {
          "directives_map": {
              "default": [
                  "SecDebugLogLevel 9",
                  "SecRuleEngine On",
                  "SecRule REQUEST_URI \"@streq /admin\" \"id:101,phase:1,t:lowercase,deny\""
              ]
          },
          "default_directives": "default"
        }
